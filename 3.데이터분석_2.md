#### 순서!
```
test.conf(apache.conf) 파일 생성 후 logstash 실행  
키바나의 index patterns에서 create!  
Discover에서 주기 조정해서 데이터 확인  
Visulization에서 Create 
  - y축 : Unique count, Field 설정(예제에서는 file, url로 함)
  - x축 : Date Histogram  
  - Split Series : Terms
```

####
- Visualize  


```
status.404
```

### 정규 표현식  
메타문자: 

#### Ruby - apache.conf  
```
input {
	file {
		path => "c:/elk/log/apache.log"
		start_position => "beginning"
		sincedb_path => "nul"
	}
}

filter {
	mutate {
		
	}
	
	dissect {
		mapping => {
			"message" => '%{clientip} %{} %{} [%{timestamp}] "%{method} %{uri} %{}" %{status} %{bytes}'

		}
	remove_field => [ "@version", "path", "host" ]
	}
	
	if "?" in [uri] {
			dissect {
					mapping => { "uri" => "%{url}?&{var}" }
					#remove_field => "uri"
			}
	} else {
			mutate {
				copy => { "uri" => "url" }
			}
	}

	if "." in [url] {
			grok {
					match => {
						"url" => ".*\/(?<file>.*)"
					}
			}
	
	if [var] {
		ruby{
			code => "event.set('var_len', event.get('var').length)"
		}
	}
	date {
		match => [ "timestamp", "dd/MMM/yyyy:HH:mm:ss Z"] 
		remove_field => [ "timestamp", "message" ]	
}
}

output{
	#stdout{}
		elasticsearch {
					hosts => "10.100.244.12"
					index => "apache-%{+yyyy}"
	}
}


```

