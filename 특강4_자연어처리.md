# 자연어처리 기술 소개 및 응용 사례 - 임수종
 
https://wikidocs.net/book/2155   
https://book.naver.com/bookdb/book_detail.nhn?bid=14797086  
자연어 프로젝트: 메일 

----
#### 전문가 시스템 - rule base system  
- rule 범위 내에서는 완벽히 작동  
- rule 외부의 문제는 답하지 못하지 못하기 때문에 2차 암흑기 옴  

#### 자연어 처리 개념
자연어 처리 <-> 인공어(문법에 맞춰 쓰고 문법 틀리면 오류 나는)  
1. 데이터가 숫자가 아니라 자연어  
2. 연구 대상이 언어이기 때문에 경계가 모호  
    자연어 처리하려면 문과 사람들과 공동 작업 해야함  
3. 자연어는 규칙으로 대체 하지 못함
    rule이 바뀌면 개발자가 수정하는 것이 아닌 데이터를 받아 학습해서 자동 업데이트  
4. 다양한 응용   

### 자연어 심층이해 기술  

```
1. 단어 이해 
  - 형태소 분석, 어휘분석, 개체명 인식
2. 문장 이해
  - 구문 분석  
3. 문맥 이해
  - 상호참조해결  
```

```
전처리 -> 자연어 구문 이해(문법 이해) -> 자연어 의미 이해
```

```
형태소 분석 -> 개체명 인식 -> 어휘 의미 분석 -> 의존 구문 분석 -> 의미역 인식 -> 상호참조해결 ->무형대용어 생략 복원
```

#### 형태소 분석
어절을 나누는 것도 어렵고 태깅 하는 것도 어려움  


#### 형태소 태그셋  
세종 태그셋  


#### Lattice 기반 형태소 분석[Mecab: EMNLP 2004]  
회사에서 많이 씀!!  

#### 개체명 인식  
주로 고유 명사 인식, 단어에 대한 의미 인식  

#### 기존 언어 분석 : 오류 전파 방지
```
입력 문서 ->  형태소 분석 -> 어휘의미 중의성 해소 -> 개체명 인식 -> 구문 분석 -> 의미역 인식 -> 상호참조해결 -> 무형대용어 복원 -> 분석 결과  
순차적 언어분석 방법은 앞 단계에서 오류가 뒷 단계로 전파됨  
```
<br>
----
## ETRI AI Open 사용한 실습
개발 기이드 -> 언어 분석 -> API

#### colab

```
#-*- coding:utf-8 -*-
import urllib3
import json
 
# 언어 분석 기술 문어/구어 중 한가지만 선택해 사용
# 언어 분석 기술(문어)
openApiURL = "http://aiopen.etri.re.kr:8000/WiseNLU" 
# 언어 분석 기술(구어)
#openApiURL = "http://aiopen.etri.re.kr:8000/WiseNLU_spoken"
 
accessKey = "04933751-7169-4df1-beba-b9b89c9a61d0"
analysisCode = "srl"
text = "법무부는 6일 오후 3시 정부과천청사에서 검찰인사위원회를 열고 검사장급 이상 고위 검찰 간부 승진·전보 인사를 논의한다. 추미애 법무부 장관 취임 이후 두 번째로 열리는 이번 인사 결과는 이날 오후 늦게나 내일 오전쯤 나올 예정이다."
 
#// 언어 분석 기술(문어)

text += """윤동주(尹東柱, 1917년 12월 30일 ~ 1945년 2월 16일)는 한국의 독립운동가, 시인, 작가이다. 
        중국 만저우 지방 지린 성 연변 용정에서 출생하여 명동학교에서 수학하였고, 숭실중학교와 연희전문학교를 졸업하였다. 숭실중학교 때 처음 시를 발표하였고, 1939년 연희전문 2학년 재학 중 소년(少年) 지에 시를 발표하며 정식으로 문단에 데뷔했다.
        일본 유학 후 도시샤 대학 재학 중 , 1943년 항일운동을 했다는 혐의로 일본 경찰에 체포되어 후쿠오카 형무소(福岡刑務所)에 투옥, 100여 편의 시를 남기고 27세의 나이에 옥중에서 요절하였다. 사인이 일본의 생체실험이라는 견해가 있고 그의 사후 일본군에 의한 마루타, 생체실험설이 제기되었으나 불확실하다. 사후에 그의 시집 《하늘과 바람과 별과 시》가 출간되었다.
        일제 강점기 후반의 양심적 지식인으로 인정받았으며, 그의 시는 일제와 조선총독부에 대한 비판과 자아성찰 등을 소재로 하였다. 그의 친구이자 사촌인 송몽규 역시 독립운동에 가담하려다가 체포되어 일제의 생체 실험으로 의문의 죽음을 맞는다. 1990년대 후반 이후 그의 창씨개명 '히라누마'가 알려져 논란이 일기도 했다. 본명 외에 윤동주(尹童柱), 윤주(尹柱)라는 필명도 사용하였다."""
#// 언어 분석 기술(구어)
#text += "네 안녕하세요 홍길동 교숩니다"+;
 
requestJson = {
    "access_key": accessKey,
    "argument": {
        "text": text,
        "analysis_code": analysisCode
    }
}
 
http = urllib3.PoolManager()
response = http.request(
    "POST",
    openApiURL,
    headers={"Content-Type": "application/json; charset=UTF-8"},
    body=json.dumps(requestJson)
)
 
print("[responseCode] " + str(response.status))
print("[responBody]")
print(str(response.data,"utf-8"))
```

#### https://jsonformatter.curiousconcept.com/
실행 결과 넣어서 편하게 보깅  
> morp: 분석결과  
    > lemma : 단어 자체, 단어에 대한 뜻  
    > type : 품사 타입  
    > 형태소 분석 기본적으로 나눌 수 있는 단위까지 나눠놓고 합쳐놓을 일 있을 때 합침  
    > 그러나 개발 특성에 따라 합친 형태로 다뤄도 됨  
    
> WSD

> NE : 개체명에 해당 되는 것만 분석된 결과 나옴  

<br>    
```
뉴스에서 명사(NNG), 동사(VV) 추출하기
```
----

## 자연어 처리 응용(QA)
자연어 질의 응답 기술 : 자연어로 기술된 문제의 의미를 이해하고, 정답을 추론하여 생성함  

#### 초기 QA 기술
오답 문장 - 1. 상호참조해결이 필요한 경우 2. 생략 성분 복원이 필요한 경우


#### 딥러닝 적용 자연어
초기에는 복잡한 경로를 빨리 풀어냈고 이것이 언어에도  적용될 줄 몰랐음  
데이터가 다르기 때문에 같은 알고리즘을 써도 서로 다른 학습 모델이 생김  

#### MRC의 전제
문서 안에 답이 있다  
질문하면 답이 해당하는 부분을 숫자로 알려줌  

딥러닝을 썼을 때 input이 질문, 정답이 들어있는 문서 / output: 정답이 들어있는 문서의 어절 위치(앞 번호 1개, 끝 번호 1개)  
엑소브레인에서 정답 찾아내는 것과 전혀 다른 방식!!  

//HCNS 챌린지???

#### MRC 시스템 예(BiDAF)
Query2Context Context2Query 2개를 만듦

전에 잘 안풀린 문제를 안써본 기법을 적용해서 풀 수 있는 능력을 가져야 함  
모든 것을 벡터화 시키기 때문에 이미지든 text든 벡터로 오기 때문에 상관 없음  

#### 문서 분류
각 분류 당 200문서는 있어야 문서의 특정 catch 할 수 있음  
분류체계가 명확해야 좋음(사람이 보기에 명확하지 않으면 학습 데이터가 명확하지 않을 것이고그럼 그거으로 학습한 인공지능은 성능이 떨어질 것!)  

- 기계 학습 : 특징 추출  
 
#### 한국어 단위 적용
무조건 2글자씩 끊어서(띄어쓰기상관하지 않고)  

ngram

#### SVM 기반 자동 분류
#### 딥러닝(CNN) 기반 자동 분류  
이미지를 부분적으로 자르면 겹치는 부분이 있기 때문에 1차원으로 하는 것보다 특성이 살아있음  

